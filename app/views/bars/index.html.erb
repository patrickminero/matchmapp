<div class="index-background-bars">
  <div class="container" data-controller="map-toggler" >
    <%# <%= link_to '< Go back', matches_path(session[:match_id]), class: 'btn btn-outline-primary mt-2 mx-3' %>
    <div class="text-center pt-4">
      <h3>Your selected match is:</h3>
    </div>
      <%= render "matches/match_card", match: @match %>
    <div data-action="click->map-toggler#toggle" data-map-toggler-target="toggleButton" id="toggleButton">
      <p class="btn btn-primary col text-center mt-1">Click here to find us on the map! <i class="fas fa-map-marked-alt"></i></p>
    </div>
    
    <div class="row">
      <div class="col-12 col-md-6" data-map-toggler-target="barView">
        <% @bars.each do |bar| %>
          <%= link_to bar_path(bar) do %>
            <div class="bar-card my-3">
              <%= cl_image_tag( bar.photos.first.key ) %>
              <div class="bar-card-infos">
                <h2 class="mt-2"><%= bar.name  %></h2>
                <p>0.2 km away</p>
                <div>
                  <% if bar.rating == 0 %>
                    <p>Not rated yet</p>
                  <% else %>
                    <p class="my-1"><% bar.rating.times do %><i class="fas fa-star text-primary"></i><% end %></p>
                  <% end %>
                </div>
                <div>
                  <% if bar.many_spaces? %>
                    <p><i class="fas fa-check-circle text-success"></i> Many spaces available</p>
                  <% elsif bar.few_spaces? %>
                    <p><i class="fas fa-exclamation-circle text-warning"></i> Few spaces available</p>
                  <% elsif bar.no_spaces? %>
                    <p class="font-weight-bold"><i class="fas fa-ban text-danger"></i> No spaces available</p>
                  <% end %>
                </div>
                
                <div class="bar-category my-2"><%= bar.category %></div>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>

      <div class="col-12 col-md-6 rounded d-none" data-map-toggler-target="mapView">
        <div data-controller="show-map" class="my-3" >
          
          <div id="map" data-target="show-map.map"
            style="width: 100%; height: 600px;"
            data-markers="<%= @markers.to_json %>"
            data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
          </div>
        </div> 
      </div>
    </div>
  </div>
</div>